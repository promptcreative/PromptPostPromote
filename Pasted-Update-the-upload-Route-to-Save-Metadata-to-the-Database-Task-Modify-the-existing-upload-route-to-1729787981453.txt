Update the /upload Route to Save Metadata to the Database
Task: Modify the existing /upload route to save uploaded image metadata into the PostgreSQL database.
Instructions:
After processing the file upload and renaming the image, save the metadata to the database. This includes saving the original filename, renamed filename, placeholder description, and hashtags.
Example:
python
Copy code
from models import Image
from utils import generate_placeholder_content

@app.route('/upload', methods=['POST'])
def upload_file():
    files = request.files.getlist("file[]")
    for file in files:
        if allowed_file(file.filename):
            filename = generate_unique_filename(file.filename)
            file.save(os.path.join(UPLOAD_FOLDER, filename))

            # Generate placeholder description and hashtags
            description, hashtags = generate_placeholder_content(filename)

            # Save metadata to database
            image = Image(
                original_filename=file.filename,
                stored_filename=filename,
                description=description,
                hashtags=hashtags
            )
            db.session.add(image)
            db.session.commit()
    return redirect(url_for('index'))
Stop here after updating the route. Verify that the images are being saved in the database with the correct metadata.
4. Add Route to Retrieve All Images from the Database
Task: Create a route to retrieve all images and their metadata from the database.
Instructions:
Add a new route /images that fetches all the records from the Image table and returns them in a JSON format.
Example:
python
Copy code
@app.route('/images', methods=['GET'])
def get_images():
    images = Image.query.all()
    return jsonify([{
        'id': image.id,
        'original_filename': image.original_filename,
        'stored_filename': image.stored_filename,
        'description': image.description,
        'hashtags': image.hashtags,
        'created_at': image.created_at
    } for image in images])
Stop here after creating the route. Test this route to ensure it returns the correct data from the database.
5. Update Frontend to Display the Images from the Database
Task: Modify the existing frontend to fetch and display the uploaded images and their metadata from the database.
Instructions:
Update the Vanilla JavaScript in main.js to fetch data from the /images route and display the images in the table.
Example:
javascript
Copy code
fetch('/images')
  .then(response => response.json())
  .then(data => {
      data.forEach(image => {
          const row = `<tr>
              <td><img src="static/uploads/${image.stored_filename}" width="100"/></td>
              <td>${image.original_filename}</td>
              <td>${image.description}</td>
              <td>${image.hashtags}</td>
              <td>${image.created_at}</td>
          </tr>`;
          document.querySelector('#imageTable tbody').insertAdjacentHTML('beforeend', row);
      });
  });
Stop here after updating the frontend. Verify that the images and metadata are being displayed in the table on the frontend.